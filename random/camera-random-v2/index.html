<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=1, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>camera-random-system-2</title>
</head>
<body>
   
    <h1>
        
    let it rain
    <!-- <label for="colorpicker" id="picker">color picker</label>
    <input type="color" id="colorpicker" value="#0000ff"> -->
    </h1>





    <!-- load p5.js   -->
    <script  src="https://cdn.jsdelivr.net/npm/p5@1.4.2/lib/p5.js"></script>   
    
    <!-- js sketch start -->
    <script id=canvas>

        let capture;
        let width = 1500;
        let height = 1000;

        let color;

        let rSlider, gSlider, bSlider;

        let magicSlider;

        function setup(){
            createCanvas(width+200, height);
            capture = createCapture(VIDEO);
            capture.hide();
            //frameRate(25);

            //console.log(createCapture);

            rSlider = createSlider(0, 255, 100);
            rSlider.position(width + 50, height/15);
            
            gSlider = createSlider(0, 255, 0);
            gSlider.position(width + 50, (height/15)+20);
           
            bSlider = createSlider(0, 255, 255);
            bSlider.position(width + 50, (height/15)+40);

            magicSlider = createSlider(0,765,100);
            magicSlider.position(width + 50, (height/15)+60);
            //magicSlider.position( 50, (height/15)+60);

           

        }

        function draw(){
            
            background(255);           
            flexibleSystem();
    }

        function flexibleSystem(){

            //////////////// CAMERA ////////////////
            
            //the camera detects a random color in the room and outputs 4 values (r,g,b,a);
            if (capture.loadedmetadata) {
            let c = capture.get(0, 0, 100, 200);        
            }

            let color = capture.get(50,50);
            //let colorInvert;  https://editor.p5js.org/awdriggs/sketches/KMOpsQfDz - color invert

            //////////////// CAMERA ////////////////


            const r = rSlider.value();
            const g = gSlider.value();
            const b = bSlider.value();

            //const magic = magicSlider.value();
            const magic = rSlider.value() + gSlider.value() + bSlider.value();
            //console.log(magic);

            console.log(magicSlider.value());

            
            
            
            //////////////// FLEXIBLE SYSTEM ////////////////
            const taille = 45;
            const numX = width/ taille;
            const numY = height/ taille;

            //randomSeed(map(mouseX,0,width,0,taille));
            randomSeed(magicSlider.value());

            strokeWeight(1);
            for( let j =0; j<numY; j++) {
                for( let i =0; i<numX; i++) { // 
                    
                const x = i*taille;
                const y = j*taille;

                stroke(r,g,b);
                fill(r,g,b);

                           
                if( random(magicSlider.value()/2) < magicSlider.value()*0.1){
                 
                
                     ellipse(x,y,taille,taille);
                    // line(x +taille,y, x, y + taille); 
                
                        
                } else {

                    push();
                    noFill();
                    //triangle(x, y, taille, taille, random(width,height), random(width/2,height/2));
                    //ellipse(x,y,taille,taille);
                    strokeWeight(4);
                    line(x +taille,y, x, y + taille); 
                    pop();     
                }
                
            }


        }

        //rect(width/2,height/2,50,50)

        //image(capture, width+40, 0, width/9, (width * capture.height / capture.width)/9);
        //image(capture, 0, 0, width/9, (width * capture.height / capture.width)/9);

        }

        function keyTyped(){

        if (key === 's') {

            saveCanvas('selfie', 'png', 1, 25);
            console.log('typed s')
        }
        
        }

        function myInputEvent() {
        console.log('you are typing: ', this.value());
        }



    </script>
    <!-- js sketch stop -->

     <!-- <script>
    document.querySelector("color").onchange = e => {
    console.log('color' + e.target.value)
    }
    </script> -->



</head>  
</body>
</html>